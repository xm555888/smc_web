/**
 * @license
 *
 * ReleaseConfig.ts: Release configuration for Sm2Shim
 * -----------------------------------------------
 * Copyright (c) 2016 - 2017, The Little Moe New LLC. All rights reserved.
 *
 * This file is part of the project 'Sm2Shim'.
 * Code released under BSD-2-Clause license.
 *
 */
var com,System,__awaiter,__generator,Sm2Shim,PlayerLoader;(function(){window.sm2ShimLoaderConfig||(window.sm2ShimLoaderConfig={debug:!1,definitionReleaseId:"",environment:"release",localizationEndpoint:"mmixstaticassets.azureedge.net/Sm2ShimRM/strings/",localizationReleaseId:"170304-0456",scriptEndpoint:"mmixstaticassets.azureedge.net/Sm2ShimRM/bin/",scriptReleaseId:"",stylesheetReleaseId:"",widgetEndpoint:"mmixstaticassets.azureedge.net/Sm2ShimRM/UserControl/",widgetReleaseId:"",stylesheetEndpoint:"mmixstaticassets.azureedge.net/Sm2ShimRM/assets/"});window.sm2ShimModules||(window.sm2ShimModules={widget:{type:"widget",description:"Sm2Shim Player Widget",name:"PlayerWidget",release:!1,releaseId:"170304-0456"},scripts:[{name:"CoreSupport",type:"script",description:"Core support library (SoundManager2, KnockoutJS, CorePromise)",releaseId:"170304-0304",release:!0},{name:"PlayerCore",type:"script",description:"Player Core",releaseId:"170304-0456",release:!0}],stylesheets:[{name:"BarUI",type:"stylesheet",description:"Player styles",releaseId:"170304-0304",release:!0}],id:"1703.304.0456.0000"})})(),function(n){var t;(function(n){function f(n){i(n)}function r(n){t.push(n);u(o,0)}function e(n){t.push(n)}function o(){var n;try{for(i=e;n=t.shift();)n.apply(undefined,[])}finally{i=r}}var t=[],i=r,u=typeof process!="undefined"&&typeof process.nextTick=="function"?process.nextTick:setTimeout;n.nextTick=f})(t=n.ciplogic||(n.ciplogic={}))}(com||(com={})),function(n){var t;(function(t){function f(n,t){for(var i=0;i<n.length;i++)t(n[i],i)}var i,r,u;(function(n){n[n.FULFILLED=0]="FULFILLED";n[n.REJECTED=1]="REJECTED";n[n.PENDING=2]="PENDING"})(i||(i={}));r=function(){function n(){this.callbacks=[null,null];this.promise=null}return n}();u=function(){function t(n){var r=this;if(!n)throw new Error("You need an executor(resolve, reject) to be passed to the constructor of a Promise");if(typeof this!="object")throw new TypeError("The this object for a Promise must be an object.");if(this instanceof Number||this instanceof String||this instanceof Date||this instanceof Boolean)throw new TypeError("The this object for a Promise must be an object.");if(typeof this._state!="undefined")throw new TypeError("Already constructed promise passed as this.");if(typeof n!="function")throw new TypeError("Executor must be a callable object.");this._followUps=[];this._state=i.PENDING;try{n(function(n){t.resolvePromise(r,n)},function(n){r._reject(n)})}catch(u){this._reject(u)}}return t.prototype.then=function(n,u){var f=new r;return typeof n=="function"&&(f.callbacks[i.FULFILLED]=n),typeof u=="function"&&(f.callbacks[i.REJECTED]=u),f.promise=new t(function(){}),this._followUps.push(f),this._notifyCallbacks(),f.promise},t.prototype.catch=function(n){return this.then(undefined,n)},t.prototype.always=function(n){return this.then(function(t){return n.apply(undefined),t},function(t){n.apply(undefined);throw t;})},t.resolve=function(n){if(typeof this!="function")throw new TypeError("The this of Promise.resolve must be a constructor.");if(n instanceof t)return n;return new this(function(i,r){t.resolvePromise({_fulfill:i,_reject:r},n)})},t.all=function(n){if(typeof this!="function")throw new TypeError("The this of Promise.all must be a constructor.");return!n||typeof n.length=="undefined"?t.reject(new TypeError("Passed a non iterable to Promise.all(): "+typeof n)):n.length==1?t.resolve(n[0]).then(function(n){return[n]}):n.length==0?t.resolve([]):new this(function(i,r){var u=n.length,e=new Array(n.length);f(n,function(n,f){t.resolve(n).then(function(n){e[f]=n;u--;u==0&&i(e)},r)})})},t.reject=function(n){if(typeof this!="function")throw new TypeError("The this of Promise.reject must be a constructor.");return new this(function(t,i){i(n)})},t.race=function(n){if(typeof this!="function")throw new TypeError("The this of Promise.race must be a constructor.");if(!n||typeof n.length=="undefined")return t.reject(new TypeError("Passed a non iterable to Promise.race(): "+typeof n));if(n.length==1)return t.resolve(n[0]).then(function(n){return[n]});if(n.length==0)return new this(function(){});for(var r=0;r<n.length;r++)if(n[r]instanceof t&&n[r]._state!=i.PENDING)return n[r];return new this(function(i,r){for(var u=0;u<n.length;u++)t.resolvePromise({_fulfill:i,_reject:r},n[u])})},t.resolvePromise=function(n,i){var u,r;if(n===i)throw new TypeError;if(typeof i!="function"&&typeof i!="object"||!i){n._fulfill(i);return}if(i instanceof t){i.then(function(t){n._fulfill(t)},function(t){n._reject(t)});return}try{u=i.then}catch(f){n._reject(f);return}if(u||typeof i!="function"||(u=i),typeof u=="function"){r=!0;try{u.call(i,function(i){r&&(r=!1,t.resolvePromise(n,i))},function(t){r&&(r=!1,n._reject(t))})}catch(f){r&&n._reject(f)}}else n._fulfill(i)},t.prototype._transition=function(n,t){this._state==i.PENDING&&(this._state=n,this._value=t,this._notifyCallbacks())},t.prototype._fulfill=function(n){return this._transition(i.FULFILLED,n),this},t.prototype._reject=function(n){return this._transition(i.REJECTED,n),this},t.prototype._notifyCallbacks=function(){var r=this,u;this._state!==i.PENDING&&(u=this._followUps,this._followUps=[],n.ciplogic.nextTick(function(){for(var f,e,n=0;n<u.length;n++){f=u[n].promise;try{u[n].callbacks[r._state]==null?f._transition(r._state,r._value):(e=u[n].callbacks[r._state].call(undefined,r._value),t.resolvePromise(f,e))}catch(o){f._transition(i.REJECTED,o)}}}))},t}();t.CorePromise=u})(t=n.ciplogic||(n.ciplogic={}))}(com||(com={}));typeof Promise=="undefined"&&(window.Promise=com.ciplogic.CorePromise),function(n){var t;(function(n){var t=function(){function n(){}return n.downloadStringAsync=function(n){return new Promise(function(t,i){var r=new XMLHttpRequest;r.open("GET",n,!0);r.onload=function(){t(r.responseText)};r.onerror=function(){i()};r.send(null)})},n}();n.WebClient=t})(t=n.Net||(n.Net={}))}(System||(System={}));
/**
 * @license
 *
 * PlayerLoader.ts: Implementation of class PlayerLoader
 * -----------------------------------------------
 * Copyright (c) The Regents of the University of California. All rights reserved.
 * Copyright (c) 2016 - 2017, The Little Moe New LLC. All rights reserved.
 *
 * This file is part of the project 'Sm2Shim'.
 * Code released under BSD-2-Clause license.
 *
 */
__awaiter=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})};__generator=this&&this.__generator||function(n,t){function e(n){return function(t){return o([n,t])}}function o(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=u[e[0]&2?"return":e[0]?"throw":"next"])&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[0,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i;return{next:e(0),"throw":e(1),"return":e(2)}},function(n){var t;(function(n){var t=System.Net.WebClient,i=function(){function n(){if(this.m_emitOnly=!1,this.m_loaderVersion="1703.304.241.0",this.m_stubRemoved=!1,console.log("This is Sm2Shim Deferred Loader "+this.m_loaderVersion+" "+(this.m_emitOnly?"DEBUG":"PROD")+", greetings from San Francisco."),console.log("Copyright (c) The Regents of the University of California. All rights reserved."),console.log("Copyright (c) 2016 - 2017, The Little Moe New LLC. All rights reserved."),window.sm2ShimLoaderConfig?this.m_config=window.sm2ShimLoaderConfig:(console.warn("PlayerLoader::constructor(): Unable to find environment configuration. That's not expected in production environment. Debug settings will be loaded."),this.m_config={debug:!0,definitionReleaseId:"",environment:"debug",localizationEndpoint:"",localizationReleaseId:"",scriptEndpoint:"localhost:63342/MediaWiki-Sm2Shim/bin/Debug/",scriptReleaseId:"",stylesheetReleaseId:"",widgetEndpoint:"localhost:63342/MediaWiki-Sm2Shim/UserControl/",widgetReleaseId:"",stylesheetEndpoint:"localhost:63342/MediaWiki-Sm2Shim/bin/Debug/assets/"},window.sm2ShimLoaderConfig=this.m_config),window.sm2ShimModules){var n=window.sm2ShimModules;n&&(console.log("Hello San Francisco, this is Seattle. We are loading bundle "+n.id+"."),this.loadDependencies(n).then(function(){console.log("PlayerLoader::constructor(): All dependencies have been loaded.")}))}else console.error("PlayerLoader::constructor(): Unable to find module definition. That's not expected in production environment.")}return n.prototype.loadDependencies=function(n){return __awaiter(this,void 0,void 0,function(){var e,u,s,r,i,f,o,h;return __generator(this,function(c){switch(c.label){case 0:if(console.log("PlayerLoader::loadDependencies(): Begin loading dependencies."),e=document.getElementsByTagName("head"),!(e&&e.length>0))return[3,9];if(n.stylesheets)for(r=0;r<n.stylesheets.length;r++)i=n.stylesheets[r],f=this.buildResourceURI(i),u=document.createElement("link"),u.rel="stylesheet",u.href=f,u.type="text/css",s=e[0],this.m_emitOnly?console.log("PlayerLoader::loadDependencies(): Will load "+u.outerHTML):(s.appendChild(u),console.log("PlayerLoader::loadDependencies(): Start loading "+i.name+" ("+i.description+")"));if(!n.scripts)return[3,8];r=0;c.label=1;case 1:if(!(r<n.scripts.length))return[3,8];i=n.scripts[r];f=this.buildResourceURI(i);c.label=2;case 2:return(c.trys.push([2,6,,7]),!!this.m_emitOnly)?[3,4]:[4,t.downloadStringAsync(f)];case 3:return o=c.sent(),o&&eval(o),console.log("PlayerLoader::loadDependencies(): Loaded "+i.name+" ("+i.description+")"),[3,5];case 4:console.log("PlayerLoader::loadDependencies(): Will load "+f);c.label=5;case 5:return[3,7];case 6:return h=c.sent(),console.error("PlayerLoader::loadDependencies(): Failed to load module "+i.name+": "+h),[3,8];case 7:return r++,[3,1];case 8:return[3,10];case 9:console.log("PlayerLoader::loadDependencies(): Precondition is not satisfied. No module was loaded.");c.label=10;case 10:return[2]}})})},n.prototype.buildResourceURI=function(n){var i="",t="",r="";switch(n.type){case"script":t=this.m_config.scriptEndpoint;r=".js";break;case"stylesheet":t=this.m_config.stylesheetEndpoint;r=".css";break;case"widget":t=this.m_config.widgetEndpoint;r=".html";break;case"localization":t=this.m_config.localizationEndpoint;r=".json"}return t&&(i+="//"+t),i+=n.name,n.releaseId&&(i+="."+n.releaseId),n.release&&(i+=".min"),i+r},n.prototype.removeStubs=function(){if(!this.m_stubRemoved){var n=document.getElementsByClassName("sm2-loading-stub");if(n)while(n.length>0)n[0].parentNode.removeChild(n[0]);this.m_stubRemoved=!0}},n}();n.PlayerLoader=i})(t=n.CoreServices||(n.CoreServices={}))}(Sm2Shim||(Sm2Shim={}));
/**
 * @license
 *
 * PlayerStub.ts: Loader for Sm2Shim
 * -----------------------------------------------
 * Copyright (c) 2016 - 2017, The Little Moe New LLC. All rights reserved.
 *
 * This file is part of the project 'Sm2Shim'.
 * Code released under BSD-2-Clause license.
 *
 */
PlayerLoader=Sm2Shim.CoreServices.PlayerLoader,function(){if(!window.sm2ShimLoader){var n=new PlayerLoader;window.sm2ShimLoader=n}}();
//# sourceMappingURL=ProdLoader.min.js.map